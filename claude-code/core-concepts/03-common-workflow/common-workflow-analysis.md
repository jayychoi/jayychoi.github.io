# common-workflow.md 심도 분석

이 문서는 Claude Code의 **실전 사용 가이드**로, 12개의 핵심 워크플로우를 다룹니다. 구조적으로 분석하면 다음과 같습니다.

## 1. 문서의 전체 설계 철학

이 문서는 **"상황 가정 → 단계별 실행 → 팁"** 패턴을 일관되게 사용합니다. "Suppose you..."로 시작하여 실제 개발 시나리오를 설정하고, 구체적인 프롬프트 예시를 제공합니다. 이는 Claude Code가 단순한 코드 생성기가 아니라 **대화형 개발 파트너**로 설계되었음을 보여줍니다.

## 2. 워크플로우를 3가지 계층으로 분류

| 계층 | 워크플로우 | 핵심 가치 |
|---|---|---|
| **탐색/이해** | 코드베이스 이해, 관련 코드 찾기, Plan Mode | 코드를 건드리지 않고 안전하게 파악 |
| **변경/생산** | 버그 수정, 리팩토링, 테스트, 문서, PR 생성 | 실제 코드 수정과 산출물 생성 |
| **운영/자동화** | Git 워크트리, 유닉스 유틸리티, 세션 관리 | 개발 프로세스 자체의 효율화 |

## 3. 주목할 만한 핵심 기능들

### Plan Mode (읽기 전용 분석)

- `Shift+Tab`으로 모드 전환이 가능하며, Normal → Auto-Accept → Plan 순서로 순환
- `--permission-mode plan`으로 CLI에서 직접 시작 가능
- 복잡한 변경 전에 안전하게 분석하는 용도로, **"먼저 계획하고 나중에 실행"** 패턴을 권장
- `Ctrl+G`로 계획을 외부 텍스트 편집기에서 직접 수정 가능

### 서브에이전트 시스템

- `/agents` 명령으로 관리하며, Claude가 자동으로 적절한 서브에이전트에 위임
- `.claude/agents/`에 프로젝트별 커스텀 에이전트를 정의하여 팀과 공유 가능
- 각 에이전트는 접근 가능한 도구를 제한할 수 있어 안전성 확보

### 확장 사고 (Extended Thinking)

- 기본 활성화, 최대 31,999 토큰의 내부 추론 예산
- `Option+T` / `Alt+T`로 토글, `Ctrl+O`로 사고 과정 확인
- "think hard", "ultrathink" 같은 문구는 **토큰 할당에 영향을 주지 않음** (일반 프롬프트 지시로만 처리)
- `MAX_THINKING_TOKENS` 환경 변수로 예산 제한 가능

### 세션 관리

- `--continue`, `--resume`, `--from-pr` 세 가지 재개 방식
- `/rename`으로 세션 이름을 지정하면 나중에 이름으로 재개 가능
- 포크된 세션은 루트 세션 아래 그룹화되어 관리됨

## 4. 실무에서 가장 유용한 패턴

### Git Worktree를 활용한 병렬 작업

하나의 저장소에서 여러 브랜치를 별도 디렉토리로 체크아웃하여 각각에서 독립적인 Claude Code 인스턴스를 실행할 수 있습니다. 장시간 작업을 Claude에 맡기고 본인은 다른 워크트리에서 개발을 계속하는 패턴이 가능합니다.

### 유닉스 파이프라인 통합

`claude -p` 플래그로 헤드리스 모드 실행이 가능하여, `cat error.txt | claude -p '...' > output.txt` 같은 파이프라인 구성이 가능합니다. CI/CD 파이프라인의 린터나 코드 리뷰어로 활용 가능합니다.

### @ 참조 시스템

`@src/utils/auth.js`처럼 파일을 직접 참조하면 Claude가 별도로 파일을 읽는 단계를 건너뛰어 대화 흐름이 빨라집니다. MCP 리소스도 `@server:resource` 형식으로 참조 가능합니다.

## 5. 문서가 암시하는 사용 전략

이 문서를 관통하는 메시지는 **"점진적 접근"**입니다:

- 넓은 질문에서 좁은 질문으로
- 읽기 전용 탐색에서 수정으로
- 작은 단위의 리팩토링과 테스트
- 계획 먼저, 실행은 나중에

Claude Code를 효과적으로 쓰려면 한 번에 큰 변경을 요청하기보다, **대화를 통해 단계적으로 범위를 좁혀가는 것**이 핵심입니다.
