# MCP(Model Context Protocol) 심층 분석 및 활용 인사이트

## 1. 문서 개요

이 문서는 Claude Code가 MCP(Model Context Protocol)를 통해 외부 도구, 데이터베이스, API에 연결하는 방법을 다룬다. MCP는 AI-도구 통합을 위한 오픈소스 표준으로, Claude Code의 기능을 수백 개의 외부 서비스로 확장할 수 있게 해준다.

---

## 2. 핵심 개념 분석

### 2.1 MCP의 본질: AI 에이전트의 "손과 발"

MCP는 단순한 API 연결이 아니라 **AI 에이전트가 실제 업무 도구와 상호작용하는 프로토콜**이다. 이는 AI가 "대화만 하는 존재"에서 "실제로 일을 하는 존재"로 전환되는 핵심 메커니즘이다.

문서에서 제시하는 활용 예시가 이를 잘 보여준다:
- JIRA 이슈 → 코드 구현 → GitHub PR 생성 (end-to-end 자동화)
- Sentry 오류 모니터링 → 원인 분석 → 배포 추적
- DB 쿼리 → 사용자 추출 → Gmail 초안 작성

이는 개별 도구 사용이 아니라 **도구 체인을 연결한 워크플로우 자동화**라는 점이 중요하다.

### 2.2 세 가지 전송 방식(Transport)의 전략적 선택

| 전송 방식 | 특징 | 적합한 상황 |
|-----------|------|------------|
| **HTTP** (권장) | 원격, 클라우드 기반 | SaaS 서비스 연결 (Notion, GitHub, Sentry 등) |
| **SSE** (deprecated) | 원격, 서버 이벤트 | 레거시 호환, 신규 사용 비권장 |
| **stdio** | 로컬 프로세스 | 시스템 직접 접근, 커스텀 스크립트, DB 연결 |

**인사이트**: SSE가 deprecated된 것은 HTTP 전송이 양방향 통신을 더 효율적으로 처리하기 때문이다. 새 프로젝트에서는 반드시 HTTP 또는 stdio를 선택해야 한다.

### 2.3 범위(Scope) 시스템의 설계 철학

세 가지 범위는 **개인 → 팀 → 크로스프로젝트**라는 계층을 형성한다:

```
우선순위: Local > Project > User
```

- **Local**: 개인 실험, 민감한 자격 증명 (기본값)
- **Project**: `.mcp.json`을 통한 팀 표준화 (버전 관리에 포함)
- **User**: 개인의 모든 프로젝트에서 사용하는 유틸리티

**인사이트**: 이 설계는 Git의 `.gitconfig` 계층(system → global → local)과 유사한 패턴을 따른다. Local이 가장 높은 우선순위를 가지므로, 팀 설정을 개인이 필요에 따라 오버라이드할 수 있다.

---

## 3. 실무 활용 전략

### 3.1 팀 개발 환경 표준화

**`.mcp.json`을 활용한 팀 도구 표준화**가 가장 실용적인 활용법이다.

```json
{
  "mcpServers": {
    "api-server": {
      "type": "http",
      "url": "${API_BASE_URL:-https://api.example.com}/mcp",
      "headers": {
        "Authorization": "Bearer ${API_KEY}"
      }
    }
  }
}
```

환경 변수 확장(`${VAR:-default}`)을 지원하므로:
- 팀 공통 설정은 `.mcp.json`에 커밋
- 개인별 자격 증명은 환경 변수로 관리
- 기본값(`:-default`)으로 로컬 개발 환경 지원

이를 통해 "신규 팀원이 프로젝트를 클론하면 바로 동일한 AI 도구 환경을 사용할 수 있다"는 효과를 얻는다.

### 3.2 개발 워크플로우 자동화 파이프라인

MCP 서버들을 조합하면 다음과 같은 자동화 파이프라인을 구축할 수 있다:

**버그 수정 파이프라인:**
1. Sentry MCP → 프로덕션 오류 감지 및 스택 트레이스 확인
2. GitHub MCP → 관련 코드 변경 이력 추적
3. PostgreSQL MCP → 영향 받는 사용자 데이터 확인
4. Claude Code → 코드 수정 및 PR 생성
5. GitHub MCP → PR 생성 및 리뷰 요청

**기능 개발 파이프라인:**
1. JIRA/Linear MCP → 이슈 상세 확인
2. Figma MCP → 디자인 스펙 확인
3. Claude Code → 코드 구현
4. GitHub MCP → PR 생성
5. Slack MCP → 팀 알림

### 3.3 Tool Search를 통한 대규모 도구 관리

MCP 서버가 많아지면 도구 정의 자체가 컨텍스트 윈도우를 압박한다. Tool Search는 이를 **지연 로딩(lazy loading)** 방식으로 해결한다.

```bash
# 컨텍스트의 5% 이상 차지하면 활성화
ENABLE_TOOL_SEARCH=auto:5 claude
```

**인사이트**: 이것은 소프트웨어 엔지니어링의 "lazy loading" 패턴을 AI 도구 관리에 적용한 것이다. MCP 서버를 10개 이상 사용하는 환경에서는 반드시 활용해야 할 기능이다.

MCP 서버 개발자라면 `instructions` 필드에 서버의 역할을 명확히 기술해야 Tool Search가 효과적으로 작동한다.

### 3.4 Claude Code를 MCP 서버로 활용

Claude Code 자체가 MCP 서버로 동작할 수 있다는 점은 주목할 만하다:

```bash
claude mcp serve
```

이를 통해:
- Claude Desktop에서 Claude Code의 파일 편집/탐색 도구를 활용
- 다른 MCP 클라이언트에서 Claude Code의 기능을 원격 도구로 사용
- Claude Code를 중심으로 한 도구 허브 구축 가능

---

## 4. 보안 및 거버넌스

### 4.1 엔터프라이즈 환경을 위한 관리형 MCP

문서는 두 가지 관리 방식을 제시한다:

**옵션 1: managed-mcp.json (독점 제어)**
- IT 관리자가 시스템 전체 경로에 배포
- 사용자가 임의의 MCP 서버를 추가할 수 없음
- 보안이 최우선인 환경에 적합

**옵션 2: 허용/차단 목록 (정책 기반 제어)**
- 사용자에게 유연성을 주되 정책으로 제한
- 서버 이름, 명령, URL 패턴 기반 제어 가능
- 차단 목록이 항상 허용 목록보다 우선

**인사이트**: 두 옵션을 결합할 수도 있다. `managed-mcp.json`으로 기본 서버를 배포하고, `allowedMcpServers`/`deniedMcpServers`로 해당 관리형 서버까지도 필터링할 수 있다.

### 4.2 보안 주의사항

문서에서 강조하는 핵심 보안 포인트:

1. **서드파티 MCP 서버의 신뢰성**: Anthropic이 모든 서버를 검증하지 않음
2. **프롬프트 인젝션 위험**: 신뢰할 수 없는 콘텐츠를 가져오는 MCP 서버는 특히 위험
3. **OAuth 자격 증명 관리**: 시스템 키체인(macOS) 또는 자격 증명 파일에 안전하게 저장
4. **Project 범위 승인**: `.mcp.json`의 서버 사용 전 명시적 승인 요청

---

## 5. 실전 권장 사항

### 5.1 시작하기 좋은 MCP 서버 조합

개발팀에서 즉시 효과를 볼 수 있는 조합:

1. **GitHub MCP** - PR 리뷰, 이슈 관리 자동화
2. **Sentry MCP** - 프로덕션 오류 모니터링 및 디버깅
3. **PostgreSQL/DB MCP** - 데이터베이스 조회 자동화

### 5.2 커스텀 MCP 서버 구축 시점

다음 상황에서 커스텀 MCP 서버 구축을 고려한다:

- 사내 전용 API와의 통합이 필요한 경우
- 기존 내부 도구를 AI 에이전트가 사용할 수 있게 하려는 경우
- 특정 도메인의 데이터 소스에 접근해야 하는 경우

[MCP SDK](https://modelcontextprotocol.io/quickstart/server)를 사용하면 비교적 빠르게 구축할 수 있다.

### 5.3 운영 시 주의할 환경 변수

| 환경 변수 | 용도 | 기본값 |
|-----------|------|--------|
| `MCP_TIMEOUT` | 서버 시작 타임아웃 | - |
| `MAX_MCP_OUTPUT_TOKENS` | 도구 출력 최대 토큰 | 25,000 |
| `ENABLE_TOOL_SEARCH` | 도구 검색 활성화 | `auto` |

### 5.4 플러그인 시스템과의 시너지

플러그인이 MCP 서버를 번들로 포함할 수 있다는 점은, **"도구 + 서버"를 하나의 패키지로 배포**할 수 있음을 의미한다. 이를 통해:

- 팀 내부 도구를 플러그인으로 패키징하여 일관된 개발 환경 구축
- `${CLAUDE_PLUGIN_ROOT}`를 활용한 상대 경로 지원으로 이식성 확보
- 플러그인 활성화만으로 MCP 서버가 자동 시작되어 설정 부담 최소화

---

## 6. 결론

MCP는 Claude Code를 단순한 코딩 어시스턴트에서 **통합 개발 자동화 플랫폼**으로 변환하는 핵심 기술이다. 특히:

1. **개인 개발자**: stdio 서버로 로컬 도구와 DB를 연결하여 생산성 극대화
2. **팀**: `.mcp.json`과 project scope로 도구 환경 표준화
3. **엔터프라이즈**: managed-mcp.json과 정책 기반 제어로 보안과 거버넌스 확보

MCP 생태계는 빠르게 성장하고 있으며, 이를 적극적으로 활용하는 팀과 그렇지 않은 팀 사이의 생산성 격차는 점점 벌어질 것이다.
